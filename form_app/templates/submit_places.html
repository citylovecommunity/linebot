{% extends "base.html" %}


{% block title %}
æäº¤åœ°é»
{% endblock %}

<head>
    <style>
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .lock-btn {
            width: 3rem;
        }
    </style>
</head>

{% block content %}

<body class="bg-light">
    <div class="container py-5">
        <h2 class="text-center mb-4">ç´„æœƒçš„é¤å»³å’Œæ™‚é–“</h2>
        <p>
            æ¯ä¸€æ®µå€¼å¾—æœŸå¾…çš„é‚€ç´„ï¼Œå¾ä½ çš„é¸æ“‡é–‹å§‹ã€‚
            è«‹å¡«å¯«å…©é–“ä½ å¿ƒå„€çš„é¤å»³ã€ä¸‰å€‹é©åˆç›¸é‡çš„æ™‚æ®µï¼Œè®“æˆ‘å€‘ç‚ºä½ å¦¥å¸–éå‡ºé€™ä»½æº«æŸ”é‚€è«‹ã€‚
        </p>
        <form method="post" action="{{ post_to }}">

            <!-- åœ°é» Section -->
            <div class="mb-3" id="place-section">
                <div class="section-header">
                    <label class="form-label">åœ°é» Google Maps é€£çµ</label>
                    <button type="button" class="btn btn-outline-secondary lock-btn"
                        onclick="toggleSectionLock('place-section', this)">ğŸ”’</button>
                </div>
                <input type="url" class="form-control mb-2" id="place1" name="place1" required readonly
                    value="{{ session['confirm_data']['place1_url'] if session.get('confirm_data') else '' }}">
                <input type="url" class="form-control" id="place2" name="place2" required readonly
                    value="{{ session['confirm_data']['place2_url'] if session.get('confirm_data') else '' }}">
            </div>

            <!-- æ™‚é–“ Section -->
            <div class="mb-3" id="time-section">
                <div class="section-header">
                    <label class="form-label">é¸æ“‡ä¸‰å€‹æ™‚é–“</label>
                    <button type="button" class="btn btn-outline-secondary lock-btn"
                        onclick="toggleSectionLock('time-section', this)">ğŸ”’</button>
                </div>
                <input type="datetime-local" class="form-control mb-2" id="time1" name="time1" required readonly
                    value="{{ session['confirm_data']['time1'] if session.get('confirm_data') else '' }}">
                <input type="datetime-local" class="form-control mb-2" id="time2" name="time2" required readonly
                    value="{{ session['confirm_data']['time2'] if session.get('confirm_data') else '' }}">
                <input type="datetime-local" class="form-control mb-2" id="time3" name="time3" required readonly
                    value="{{ session['confirm_data']['time3'] if session.get('confirm_data') else '' }}">
            </div>
            <p>
                é—œæ–¼é¤æ¡Œä¸Šçš„å°è©±èˆ‡çœ¼ç¥ï¼Œäº¤çµ¦æ™‚é–“å’Œç·£åˆ†å®‰æ’ã€‚
            </p>
            <!-- ç•™è¨€ Section (no lock) -->
            <div class="mb-3">
                <label for="comment" class="form-label">ç•™è¨€çµ¦å°æ–¹ï¼ˆé¸å¡«ï¼‰</label>
                <textarea class="form-control" id="comment" name="comment" rows="3"
                    placeholder="è¼¸å…¥æ‚¨æƒ³å°å°æ–¹èªªçš„è©±...">{{ session['confirm_data']['comment'] if session.get('confirm_data') else '' }}</textarea>
            </div>

            <!-- æäº¤æŒ‰éˆ• -->
            <div class="text-center">
                <button type="submit" class="btn btn-success me-2">ç¢ºèªé€å‡º</button>
                {% if go_back_url %}
                <a href="{{ go_back_url }}" class="btn btn-outline-secondary">è¿”å›ä¸Šé </a>
                {% endif %}
            </div>
        </form>
    </div>

    <script>
        function toggleSectionLock(sectionId, btn) {
            const section = document.getElementById(sectionId);
            const inputs = section.querySelectorAll('input');
            const isLocked = inputs[0].hasAttribute('readonly');

            inputs.forEach(input => {
                if (isLocked) {
                    input.removeAttribute('readonly');
                } else {
                    input.setAttribute('readonly', true);
                }
            });

            btn.textContent = isLocked ? 'ğŸ”“' : 'ğŸ”’';
        }
    </script>
</body>

{% endblock %}