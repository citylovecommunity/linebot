{% extends "base.html" %}


{% block title %}
提交地點
{% endblock %}


{% block content %}


<h1 class="display-5 fw-bold text-body-emphasis">{{ dating_title }}</h1>
<div class="col-lg-6 mx-auto">
    <p class="lead mb-4">{{ first_word|safe }}</p>
</div>

<form class="needs-validation" method="post" action="{{ post_to }}">
    <div class="row g-3">
        <div class="col-12 mb-3">
            <label for="place1" class="form-label">第一間餐廳</label>
            <div class="input-group">
                <input type="url" class="form-control" id="place1" name="place1" required {% if lock %} disabled {%
                    endif %} value="{{ session['confirm_data']['place1_url'] if session.get('confirm_data') else '' }}"
                    placeholder="請貼上Google Map網址">
                {% if lock %}
                <button class="btn btn-outline-secondary ms-2" type="button" onclick="enableInput('place1')">重填</button>
                {% endif %}
            </div>
            <div class="invalid-feedback">
                請輸入有效的 Google Map 網址。
            </div>
        </div>

        <div class="col-12 mb-3">
            <label for="place2" class="form-label">第二間餐廳</label> <span class="text-body-secondary">(選填)</span>
            <div class="input-group">
                <input type="url" class="form-control" id="place2" name="place2" {% if lock %} disabled {% endif %}
                    value="{{ session['confirm_data']['place2_url'] if session.get('confirm_data') else '' }}">
                {% if lock %}
                <button class="btn btn-outline-secondary ms-2" type="button" onclick="enableInput('place2')">重填</button>
                {% endif %}
            </div>
            <div class="invalid-feedback">
                Please enter your shipping address.
            </div>
        </div>

        <div class="col-12 mb-3">
            <label for="time1" class="form-label">time1</label>
            <div class="input-group">
                <input type="datetime-local" class="form-control mb-2" id="time1" name="time1" required {% if lock %}
                    disabled {% endif %}
                    value="{{ session['confirm_data']['time1'] if session.get('confirm_data') else '' }}">
                {% if lock %}
                <button class="btn btn-outline-secondary  ms-2" type="button" onclick="enableInput('time1')">重填</button>
                {% endif %}
            </div>
        </div>
        <div class="col-12 mb-3">
            <label for="time2" class="form-label">time2 <span class="text-body-secondary">(選填)</span></label>
            <div class="input-group">
                <input type="datetime-local" class="form-control mb-2" id="time2" name="time2" {% if lock %} disabled {%
                    endif %} value="{{ session['confirm_data']['time2'] if session.get('confirm_data') else '' }}">
                {% if lock %}
                <button class="btn btn-outline-secondary ms-2" type="button" onclick="enableInput('time2')">重填</button>
                {% endif %}
            </div>
        </div>
        <div class="col-12 mb-3">
            <label for="time3" class="form-label">time3 <span class="text-body-secondary">(選填)</span></label>
            <div class="input-group">
                <input type="datetime-local" class="form-control mb-2" id="time3" name="time3" {% if lock %} disabled {%
                    endif %} value="{{ session['confirm_data']['time3'] if session.get('confirm_data') else '' }}">
                {% if lock %}
                <button class="btn btn-outline-secondary ms-2" type="button" onclick="enableInput('time3')">重填</button>
                {% endif %}
            </div>
        </div>

        <div class="col-md-12">
            <label for="comment" class="form-label">留言給對方 <span class="text-body-secondary">(選填)</span></label>
            <textarea class="form-control" id="comment" name="comment" rows="3" placeholder="輸入您想對對方說的話...">
                </textarea>
        </div>
    </div>

    <div class="d-flex justify-content-center gap-3 mt-4 mb-5">
        <button class="w-50 btn btn-primary btn-lg" type="submit">確認送出</button>
        {% if go_back_url %}
        <a href="{{ go_back_url }}" class="w-50 btn btn-outline-secondary btn-lg">返回上頁</a>
        {% endif %}
    </div>
</form>

{% if lock %}
<script>
    function enableInput(inputId) {
        var input = document.getElementById(inputId);
        input.removeAttribute('disabled');
        input.value = ''; // Clear the value
        input.focus();
    }
    document.querySelector('form.needs-validation').addEventListener('submit', function (e) {
        // Enable all disabled inputs before submit
        this.querySelectorAll('input:disabled').forEach(function (input) {
            input.removeAttribute('disabled');
        });
    });
</script>
{% endif %}

{% endblock %}