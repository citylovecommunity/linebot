<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <title>æäº¤åœ°é»</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .lock-btn {
            width: 3rem;
        }
    </style>
</head>

<body class="bg-light">
    <div class="container py-5">
        <h2 class="text-center mb-4">{{session['sub_name']}}å’Œ{{session['obj_name']}}ç´„æœƒçš„é¤å»³å’Œæ™‚é–“</h2>
        <form method="post" action="{{ post_to }}">

            <!-- åœ°é» Section -->
            <div class="mb-3" id="place-section">
                <div class="section-header">
                    <label class="form-label">åœ°é» Google Maps é€£çµ</label>
                    <button type="button" class="btn btn-outline-secondary lock-btn"
                        onclick="toggleSectionLock('place-section', this)">ğŸ”’</button>
                </div>
                <input type="url" class="form-control mb-2" id="place1" name="place1" required readonly
                    value="{{ session['confirm_data']['place1_url'] if session.get('confirm_data') else '' }}">
                <input type="url" class="form-control" id="place2" name="place2" required readonly
                    value="{{ session['confirm_data']['place2_url'] if session.get('confirm_data') else '' }}">
            </div>

            <!-- æ™‚é–“ Section -->
            <div class="mb-3" id="time-section">
                <div class="section-header">
                    <label class="form-label">é¸æ“‡ä¸‰å€‹æ™‚é–“</label>
                    <button type="button" class="btn btn-outline-secondary lock-btn"
                        onclick="toggleSectionLock('time-section', this)">ğŸ”’</button>
                </div>
                <input type="datetime-local" class="form-control mb-2" id="time1" name="time1" required readonly
                    value="{{ session['confirm_data']['time1'] if session.get('confirm_data') else '' }}">
                <input type="datetime-local" class="form-control mb-2" id="time2" name="time2" required readonly
                    value="{{ session['confirm_data']['time2'] if session.get('confirm_data') else '' }}">
                <input type="datetime-local" class="form-control mb-2" id="time3" name="time3" required readonly
                    value="{{ session['confirm_data']['time3'] if session.get('confirm_data') else '' }}">
            </div>

            <!-- ç•™è¨€ Section (no lock) -->
            <div class="mb-3">
                <label for="comment" class="form-label">ç•™è¨€çµ¦å°æ–¹ï¼ˆé¸å¡«ï¼‰</label>
                <textarea class="form-control" id="comment" name="comment" rows="3"
                    placeholder="è¼¸å…¥æ‚¨æƒ³å°å°æ–¹èªªçš„è©±...">{{ session['confirm_data']['comment'] if session.get('confirm_data') else '' }}</textarea>
            </div>

            <!-- æäº¤æŒ‰éˆ• -->
            <div class="text-center">
                <button type="submit" class="btn btn-success me-2">ç¢ºèªé€å‡º</button>
                {% if go_back_url %}
                <a href="{{ go_back_url }}" class="btn btn-outline-secondary">è¿”å›ä¸Šé </a>
                {% endif %}
            </div>
        </form>
    </div>

    <script>
        function toggleSectionLock(sectionId, btn) {
            const section = document.getElementById(sectionId);
            const inputs = section.querySelectorAll('input');
            const isLocked = inputs[0].hasAttribute('readonly');

            inputs.forEach(input => {
                if (isLocked) {
                    input.removeAttribute('readonly');
                } else {
                    input.setAttribute('readonly', true);
                }
            });

            btn.textContent = isLocked ? 'ğŸ”“' : 'ğŸ”’';
        }
    </script>
</body>

</html>