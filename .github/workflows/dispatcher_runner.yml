name: dispatcher_runner

on:
  schedule:
    - cron: '* * * * *'  
  workflow_dispatch:
  push:  

jobs:
  dispatcher_runner:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4.2.2


      - name: Set up uv
        run: curl -LsSf https://astral.sh/uv/install.sh | sh

      - name: Install Dependencies
        run: cd senders && uv sync
        
      - name: Make Sure Where I am 
        run: ls 

      - name: Run Script
        run: pwd && uv run python -m scripts.run_all_dispatchers
        env: 
            DB: ${{ secrets.TEST_DB }}
            LINE_CHANNEL_SECRET: ${{ secrets.TEST_DB }}
            LINE_CHANNEL_ACCESS_TOKEN: ${{ secrets.TEST_DB }}
            TEST_USER_ID: ${{ secrets.TEST_DB }}
            ADMIN_LINE_ID: ${{ secrets.TEST_DB }}
            FORM_WEB_URL: ${{ secrets.TEST_DB }}
